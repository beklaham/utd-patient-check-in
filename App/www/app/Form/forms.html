<!DOCTYPE>
<html>

<head>
  <title>FORMS</title>
</head>

<body>

  <ion-view>
  
    <div class="bar bar-header bar-positive" ng-controller="InsideCtrl">
      <h1 class="form-title">Patient Forms</h1>
      <button class="signout" ng-click="logout()">
        Sign Out
      </button>
    </div>

    <ion-content class="has-header" scroll="false">
      <div ng-controller="FormCtrl as form">
      <!-- Amy added this button to test her API calls (adds Questionnaires to the list) -->
        <md-content layout-padding="" ng-hide="showForm" class = "formstyle">
          <ul>
            <!-- <ul ng-repeat="question in QuestionnaireList"> -->
              <li ng-repeat="quest in QuestionnaireList">
                <md-list>
                  <md-list-item class="secondary-button-padding">
                    <p>{{quest.QuestionnaireName}}</p>
                    <md-button class="incomplete-button" ng-if="!quest.IsComplete" ng-click="goToForm(quest.RelSurveyPatientId)">Incomplete</md-button>
                    <md-button class="complete-button" ng-if="quest.IsComplete" ng-click="goToForm(quest.RelSurveyPatientId)"> Completed Form</md-button>
                  </md-list-item>
                </md-list>
              </li>
            </ul>
          <!-- </ul> -->
        </md-content>



        <md-content ng-hide="!showForm" class = "questionnaire-border" > <!-- Amy added this so that it toggles with the other md-content -->
        <!-- <ul ng-repeat="question in QuestionnaireList"> -->
        <button ng-click="showForm=false" class = "close-button">X</button>
          <li ng-repeat="quest in QuestionnaireList">
          <ul>
            <li ng-repeat="sects in questionnaire.Questionnaire.Sections"> <!-- <li ng-repeat="sects in quest.Sections"> -->
              {{currentSectionId=sects.SurveySectionId;""}}
            <div ng-show="showForm && quest.RelSurveyPatientId == questionnaireId && sectionIndex == $index">
            <div layout="row" flex>
             <md-content layout-padding class = "questionnaire-layout">
                
                    <md-subheader class = "questionnaire-header">{{sects.SurveySectionName}}</md-subheader>
                    <ul>
                      <li>
                        <ul ng-repeat="q in sects.Questions">
                          <p></p>
                          <!-- extra space between questions -->
                          <div ng-if="!q.QuestionOptional">
                            <p> {{q.SurveyQuestionLabel}}</p>
                            
                            <div ng-if="q.SurveyControlTypeName == 'RADIOBUTTON'">
                                <md-radio-group 
                                  ng-required="true"
                                  layout="row" 
                                  ng-model="answersMap[q.SurveyQuestionId]" 
                                  class="md-accent">
                                    <md-radio-button 
                                      ng-repeat="answer in q.Answers" 
                                      ng-value="answer.SurveyAnswerId">
                                      {{answer.SurveyAnswerLabel}}
                                    <br/>
                                  </md-radio-button>
                                </md-radio-group>
                              </div>

                            <div ng-if="q.SurveyControlTypeName == 'TEXT'">
                              <!-- Code for Textbox goes here-->
                              <li><ul><li><ul ng-repeat="answers in q.Answers">
                               <md-input-container class="md-block">
                                  <label> {{answers.SurveyAnswerLabel}}</label>
                                  <textarea ng-model="answer.text" name="q.SurveyQuestionId"></textarea>
                                </md-input-container>
                              </ul></li></ul></li>
                            </div>


                            <div ng-if="q.SurveyControlTypeName == 'TIMEFRAME'">
                              <!-- Code for timeframe goes here-->
                              <li>
                                <ul>
                                  <li>
                                    <ul ng-repeat="answers in q.Answers">

                                    </ul>
                                  </li>
                                </ul>
                              </li>
                            </div>


                            <div ng-if="q.SurveyControlTypeName == 'CHECKBOX'">
                              <!-- Code for checkbox goes here-->   
                                <div layout="row" layout-wrap layout-padding flex>
                                  <div flex="50" ng-repeat="answers in q.Answers">
                                    <md-checkbox >
                                      {{answers.SurveyAnswerLabel}}
                                    </md-checkbox>
                                  </div>
                                  </div>
                              </div>

                              <div ng-if="q.SurveyControlTypeName == 'NUMERIC'">
                                  <md-radio-group 
                                  ng-required="true"
                                  layout="row" 
                                  ng-model="answersMap[q.SurveyQuestionId]" 
                                  class="md-accent">
                                    <md-radio-button 
                                      ng-repeat="answer in q.Answers" 
                                      ng-value="answer.SurveyAnswerId"
                                      ng-style="{'display':'inline'}">
                                      {{answer.SurveyAnswerLabel}}
                                    <br/>
                                  </md-radio-button>
                                </md-radio-group>
                              </div>
                              
                              </div>

                        </ul>
                      </li>
                    </ul>
                    
                    
                    <div layout="row" layout-align="end end">
                      <div ng-if = "$index != 0">
                        <md-button class="nav-button" ng-click="goToPrevious()">Previous Page</md-button>
                      </div>
                      <div ng-if = "getLen()-1 != $index">
                        <md-button class="nav-button" ng-click="goToNext()">Next Page</md-button>
                      </div>
                      <div ng-if = "getLen()-1 == $index">
                        <md-button class="review-button" ng-click="goToReview()">Review Answers</md-button>
                      </div>
                    </div>

                   </md-content>
               </div>
              </div>
              </li>
              </ul>
          </li>
        <!-- </ul> -->
        
        
      </md-content>
      </div>
      

    </ion-content>
  </ion-view>


</body>

</html>
    
